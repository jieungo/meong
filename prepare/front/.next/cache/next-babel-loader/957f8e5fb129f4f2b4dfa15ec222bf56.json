{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nvar __jsx = React.createElement;\nimport React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { Button, Form, Input } from 'antd';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { DownloadOutlined } from '@ant-design/icons';\nimport styled from 'styled-components';\nimport { ADD_POST_REQUEST, UPLOAD_IMAGES_REQUEST, REMOVE_IMAGE } from '../reducers/post';\nimport useInput from '../hooks/useInput';\nvar SubmitBtn = styled(Button).withConfig({\n  displayName: \"PostForm__SubmitBtn\",\n  componentId: \"sc-1s3n0yo-0\"\n})([\"background-color:#FFF3D4;color:#857171;border:none;margin:20px auto;width:100%;margin-bottom:40px;height:40px;font-weight:500;&:hover{background-color:#857171;border:1px solid #857171;color:white;}\"]);\nvar FileUploadWrapper = styled.div.withConfig({\n  displayName: \"PostForm__FileUploadWrapper\",\n  componentId: \"sc-1s3n0yo-1\"\n})([\"display:flex;#file[type=\\\"file\\\"]{display:none;}.label-holder{display:flex;margin:1em auto;width:100%;height:30vh;}.label{display:grid;place-items:center;font-size:1rem;cursor:pointer;border:2px dashed gray;border-radius:5px;width:100%;padding:10vh 0;}.label > span{display:flex;flex-direction:column;font-weight:500;font-size:1.1rem;color:gray;}.result{width:100%;margin-top:1rem;display:flex;flex-wrap:wrap;justify-content:left;}\"]);\nvar SelectedImg = styled.img.withConfig({\n  displayName: \"PostForm__SelectedImg\",\n  componentId: \"sc-1s3n0yo-2\"\n})([\"display:flex;align-items:center;justify-content:center;width:100%;\"]);\nvar FormWrapper = styled(Form).withConfig({\n  displayName: \"PostForm__FormWrapper\",\n  componentId: \"sc-1s3n0yo-3\"\n})([\"width:100%;margin:0 auto;\"]);\n\nvar PostForm = function PostForm() {\n  var _useSelector = useSelector(function (state) {\n    return state.post;\n  }),\n      imagePaths = _useSelector.imagePaths,\n      addPostDone = _useSelector.addPostDone;\n\n  var dispatch = useDispatch();\n\n  var _useInput = useInput(''),\n      _useInput2 = _slicedToArray(_useInput, 3),\n      text = _useInput2[0],\n      onChangeText = _useInput2[1],\n      setText = _useInput2[2];\n\n  var _useState = useState(true),\n      showUploadButton = _useState[0],\n      setShowUploadButton = _useState[1];\n\n  useEffect(function () {\n    if (addPostDone) {\n      setText('');\n    }\n  }, [addPostDone]);\n  var onSubmit = useCallback(function () {\n    if (!text || !text.trim()) {\n      return alert('게시글을 작성하세요.');\n    }\n\n    var formData = new FormData();\n    imagePaths.forEach(function (p) {\n      formData.append('image', p);\n    });\n    formData.append('content', text);\n    return dispatch({\n      type: ADD_POST_REQUEST,\n      data: formData\n    });\n  }, [text, imagePaths]);\n  var imageInput = useRef();\n  var onClickImageUpload = useCallback(function () {\n    imageInput.current.click();\n  }, [imageInput.current]);\n  var onChangeImages = useCallback(function (e) {\n    console.log('images', e.target.files);\n    var imageFormData = new FormData();\n    [].forEach.call(e.target.files, function (f) {\n      imageFormData.append('image', f);\n    });\n    dispatch({\n      type: UPLOAD_IMAGES_REQUEST,\n      data: imageFormData\n    });\n    setShowUploadButton(false);\n  }, []);\n  var onRemoveImage = useCallback(function (index) {\n    return function () {\n      dispatch({\n        type: REMOVE_IMAGE,\n        data: index\n      });\n      setShowUploadButton(true);\n    };\n  }, []);\n  return __jsx(FormWrapper, {\n    encType: \"multipart/form-data\",\n    onFinish: onSubmit\n  }, showUploadButton && __jsx(FileUploadWrapper, null, __jsx(\"input\", {\n    type: \"file\",\n    name: \"image\",\n    multiple: true,\n    hidden: true,\n    ref: imageInput,\n    onChange: onChangeImages\n  }), __jsx(\"div\", {\n    className: \"label-holder\",\n    onClick: onClickImageUpload\n  }, __jsx(\"label\", {\n    htmlFor: \"file\",\n    className: \"label\"\n  }, __jsx(\"span\", null, __jsx(DownloadOutlined, {\n    style: {\n      fontSize: '30px',\n      marginBottom: '10px'\n    }\n  }), \"Upload Images\")))), __jsx(\"div\", null, imagePaths.map(function (v, i) {\n    return __jsx(\"div\", {\n      key: v,\n      style: {\n        position: 'relative'\n      }\n    }, __jsx(SelectedImg, {\n      src: \"http://localhost:3065/\".concat(v),\n      alt: v\n    }), __jsx(Button, {\n      onClick: onRemoveImage(i),\n      style: {\n        position: 'absolute',\n        zIndex: 1,\n        top: 0,\n        right: 0\n      }\n    }, \"X\"));\n  })), __jsx(Input.TextArea, {\n    value: text,\n    onChange: onChangeText,\n    maxLength: 300,\n    placeholder: \"\\uBC18\\uB824\\uB3D9\\uBB3C\\uC5D0 \\uB300\\uD55C \\uC790\\uC720\\uB85C\\uC6B4 \\uAE00\\uC744 \\uC791\\uC131\\uD574\\uC8FC\\uC138\\uC694\"\n  }), __jsx(SubmitBtn, {\n    htmlType: \"submit\"\n  }, \"\\uC5C5\\uB85C\\uB4DC\"));\n};\n\nexport default PostForm;","map":null,"metadata":{},"sourceType":"module"}